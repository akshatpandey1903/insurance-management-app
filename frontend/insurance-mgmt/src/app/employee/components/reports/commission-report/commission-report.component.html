<app-navbar></app-navbar>

<div class="container py-4" style="background-color: #f8f9fa; min-height: calc(100vh - 56px);">
  <div class="card shadow-sm" style="border-radius: 10px; border: none;">
    <div class="card-header" style="background-color: #2c3e50; color: white; border-radius: 10px 10px 0 0 !important; padding: 12px 20px;">
      <input 
          type="text" 
          style="position: absolute; right: 20px;"
          class="form-control w-25 h-200" 
          placeholder="Search in agent commissions..." 
          [(ngModel)]="keyword" 
          (input)="searchAgents()"
        />
      <h3 class="mb-0" style="font-weight: 600;"><i class="bi bi-graph-up me-2"></i>Agent Commission Report</h3>
      
        
    </div>
    
    <div class="card-body" style="padding: 0;">
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead style="background-color: #2c3e50; color: white;">
            <tr>
              <th style="padding: 12px 16px; font-weight: 500;">#</th>
              <th style="padding: 12px 16px; font-weight: 500;">Agent Name</th>
              <th style="padding: 12px 16px; font-weight: 500;">Email</th>
              <th style="padding: 12px 16px; font-weight: 500;">Policies Sold</th>
              <th style="padding: 12px 16px; font-weight: 500;">Commission Rate</th>
              <th style="padding: 12px 16px; font-weight: 500; text-align: right;">Total Earnings</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let agent of agentCommissions; let i = index" style="transition: background-color 0.2s ease;">
              <td style="padding: 12px 16px;">{{ i + 1 + (page * size) }}</td>
              <td style="padding: 12px 16px; font-weight: 500;">{{ agent.firstName }} {{ agent.lastName }}</td>
              <td style="padding: 12px 16px;">{{ agent.email }}</td>
              <td style="padding: 12px 16px;">
                <span style="background-color: #0d6efd; color: white; border-radius: 10rem; padding: 0.25em 0.6em; font-size: 0.85em;">
                  {{ agent.totalPoliciesSold }}
                </span>
              </td>
              <td style="padding: 12px 16px;">{{ agent.totalCommissionRate }}%</td>
              <td style="padding: 12px 16px; text-align: right; color: #198754; font-weight: 600;">â‚¹{{ agent.totalEarnings | number:'1.2-2' }}</td>
            </tr>
            <tr *ngIf="agentCommissions.length === 0">
              <td colspan="6" style="text-align: center; padding: 40px; color: #6c757d;">
                <div>
                  <i class="bi bi-currency-exchange" style="font-size: 2rem; color: #adb5bd;"></i>
                  <h5 style="margin-top: 1rem; margin-bottom: 0.5rem;">No Commission Data</h5>
                  <p style="margin-bottom: 0;">There are currently no commission records to display</p>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="card-footer" style="background-color: white; border-top: 1px solid rgba(0,0,0,.125); padding: 16px 20px;">
      <div class="d-flex justify-content-between">
        <button 
          class="btn btn-primary" 
          [disabled]="page === 0" 
          (click)="prevPage()"
          style="padding: 6px 16px; border-radius: 4px;"
        >
          <i class="bi bi-chevron-left"></i> Previous
        </button>
        <button 
          class="btn btn-primary" 
          [disabled]="page === totalPages - 1" 
          (click)="nextPage()"
          style="padding: 6px 16px; border-radius: 4px;"
        >
          Next <i class="bi bi-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>
</div>